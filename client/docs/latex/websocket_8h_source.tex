\doxysection{websocket.\+h}
\hypertarget{websocket_8h_source}{}\label{websocket_8h_source}\index{core/websocket.h@{core/websocket.h}}
\mbox{\hyperlink{websocket_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ CORE\_WEBSOCKET\_HEADER}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ CORE\_WEBSOCKET\_HEADER}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{base_8h}{base.h}}"{}}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#ifdef\ FEAT\_MULTIPLAYER}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <cpr/cpr.h>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{definition_8h}{../adapter/definition.h}}"{}}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{keyword}{typedef}\ boost::beast::websocket::stream<boost::asio::ip::tcp::socket>\ socket\_stream;}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{keyword}{enum}\ LobbyStatus}
\DoxyCodeLine{00017\ \{}
\DoxyCodeLine{00018\ \ \ \ \ LOBBY\_UNCONNECTED,}
\DoxyCodeLine{00019\ \ \ \ \ LOBBY\_NOT\_FOUND,}
\DoxyCodeLine{00020\ \ \ \ \ LOBBY\_USER\_REFUSED,}
\DoxyCodeLine{00021\ \ \ \ \ LOBBY\_CONNECTED}
\DoxyCodeLine{00022\ \};}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \textcolor{keyword}{class\ }HTTPAdapter}
\DoxyCodeLine{00026\ \{}
\DoxyCodeLine{00027\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00028\ \ \ \ \ HTTPAdapter(\textcolor{keywordtype}{string}\&\ host,\textcolor{keywordtype}{string}\&\ port);}
\DoxyCodeLine{00029\ \ \ \ \ \textcolor{keywordtype}{bool}\ create\_user(\textcolor{keywordtype}{string}\&\ username,\textcolor{keywordtype}{string}\&\ password);}
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{keywordtype}{string}\ authenticate\_on\_server(\textcolor{keywordtype}{string}\&\ username,\textcolor{keywordtype}{string}\&\ password);}
\DoxyCodeLine{00031\ \ \ \ \ LobbyStatus\ open\_lobby(\textcolor{keywordtype}{string}\&\ lobby\_name,\textcolor{keywordtype}{string}\&\ lobby\_password,\textcolor{keywordtype}{string}\&\ jwt\_token,\textcolor{keywordtype}{bool}\ create);}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{keywordtype}{string}\ m\_Addr;}
\DoxyCodeLine{00035\ \};}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \textcolor{keyword}{class\ }Websocket}
\DoxyCodeLine{00039\ \{}
\DoxyCodeLine{00040\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00041\ \ \ \ \ Websocket()\ \{\ \ \}}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keywordtype}{void}\ connect(\textcolor{keywordtype}{string}\ host,\textcolor{keywordtype}{string}\ port\_ad,\textcolor{keywordtype}{string}\ port\_ws,\textcolor{keywordtype}{string}\ name,\textcolor{keywordtype}{string}\ pass,\textcolor{keywordtype}{string}\ lnom,}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ lpass,\textcolor{keywordtype}{bool}\ create);}
\DoxyCodeLine{00044\ \ \ \ \ ServerMessage\ receive\_message();}
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{keywordtype}{void}\ send\_message(ClientMessage\ msg);}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keywordtype}{void}\ exit();}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{comment}{//\ system}}
\DoxyCodeLine{00051\ \ \ \ \ boost::asio::io\_context\ ioc;}
\DoxyCodeLine{00052\ \ \ \ \ socket\_stream\ ws\{ioc\};}
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{keywordtype}{bool}\ running\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{comment}{//\ status}}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keywordtype}{string}\ username;}
\DoxyCodeLine{00057\ \ \ \ \ LobbyStatus\ lobby\_status\ =\ LOBBY\_UNCONNECTED;}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{comment}{//\ messages}}
\DoxyCodeLine{00060\ \ \ \ \ ServerMessage\ server\_state;}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keywordtype}{bool}\ state\_update\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00062\ \ \ \ \ std::queue<ClientMessage>\ client\_messages;}
\DoxyCodeLine{00063\ \ \ \ \ std::mutex\ mutex\_server\_state;}
\DoxyCodeLine{00064\ \ \ \ \ std::mutex\ mutex\_client\_messages;}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00067\ \ \ \ \ std::thread\ m\_HandleWebsocketDownload;}
\DoxyCodeLine{00068\ \ \ \ \ std::thread\ m\_HandleWebsocketUpload;}
\DoxyCodeLine{00069\ \ \ \ \ \textcolor{keywordtype}{bool}\ connected\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00070\ \};}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \textcolor{preprocessor}{\#ifdef\ FEAT\_MULTIPLAYER}}
\DoxyCodeLine{00074\ \textcolor{keyword}{inline}\ Websocket\ g\_Websocket;}
\DoxyCodeLine{00075\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00079\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
