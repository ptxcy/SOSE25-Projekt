\chapter{HTTP Adapter ({\ttfamily http-\/adapter.\+cpp}) using Crow }
\hypertarget{md_doc_2http-adapter-explaination}{}\label{md_doc_2http-adapter-explaination}\index{HTTP Adapter ($<$tt$>$http-\/adapter.cpp$<$/tt$>$) using Crow@{HTTP Adapter ($<$tt$>$http-\/adapter.cpp$<$/tt$>$) using Crow}}
\label{md_doc_2http-adapter-explaination_autotoc_md37}%
\Hypertarget{md_doc_2http-adapter-explaination_autotoc_md37}%
\hypertarget{md_doc_2http-adapter-explaination_autotoc_md38}{}\doxysection{\texorpdfstring{Overview}{Overview}}\label{md_doc_2http-adapter-explaination_autotoc_md38}
This C++ file provides functions for sending HTTP GET and POST requests to the Auth\+Proxy service using the {\bfseries{Crow C++}} library.

{\bfseries{Important Considerations\+:}}


\begin{DoxyItemize}
\item {\bfseries{Crow for Client\+:}} This implementation leverages the Crow C++ framework for client operations.
\item {\bfseries{Dependencies\+:}} This implementation requires the {\bfseries{Crow C++ Library}} to be correctly installed and accessible (headers and linking).
\item {\bfseries{URL Parsing\+:}} The code includes a regex-\/based URL parsing implementation.
\item {\bfseries{Base64\+:}} For Basic Authentication, Crow\textquotesingle{}s built-\/in base64 encoding utilities are used.
\end{DoxyItemize}\hypertarget{md_doc_2http-adapter-explaination_autotoc_md39}{}\doxysection{\texorpdfstring{Key Components}{Key Components}}\label{md_doc_2http-adapter-explaination_autotoc_md39}
\hypertarget{md_doc_2http-adapter-explaination_autotoc_md40}{}\doxysubsection{\texorpdfstring{1. {\ttfamily Http\+Response} Struct}{1. {\ttfamily Http\+Response} Struct}}\label{md_doc_2http-adapter-explaination_autotoc_md40}

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{struct\ }HttpResponse\ \{}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{int}\ http\_code;}
\DoxyCodeLine{\ \ \ \ std::string\ body;}
\DoxyCodeLine{\ \ \ \ std::string\ authorizationHeader;\ \textcolor{comment}{//\ Stores\ 'Authenticate'\ or\ 'Authorization'\ header\ value}}
\DoxyCodeLine{\};}

\end{DoxyCode}



\begin{DoxyItemize}
\item Returns information about the HTTP response.
\item {\ttfamily http\+\_\+code}\+: HTTP status code.
\item {\ttfamily body}\+: Response body string.
\item {\ttfamily authorization\+Header}\+: Value of the {\ttfamily Authenticate} (preferred) or {\ttfamily Authorization} header from the response.
\end{DoxyItemize}\hypertarget{md_doc_2http-adapter-explaination_autotoc_md41}{}\doxysubsection{\texorpdfstring{2. Base64 Encoding}{2. Base64 Encoding}}\label{md_doc_2http-adapter-explaination_autotoc_md41}

\begin{DoxyCode}{0}
\DoxyCodeLine{std::string\ base64\_encode(\textcolor{keyword}{const}\ std::string\&\ input)}

\end{DoxyCode}



\begin{DoxyItemize}
\item Utilizes Crow\textquotesingle{}s built-\/in {\ttfamily crow\+::utility\+::base64encode} for Base64 encoding.
\item Used for creating Basic Authentication headers.
\end{DoxyItemize}\hypertarget{md_doc_2http-adapter-explaination_autotoc_md42}{}\doxysubsection{\texorpdfstring{3. URL Parsing}{3. URL Parsing}}\label{md_doc_2http-adapter-explaination_autotoc_md42}

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{struct\ }UrlComponents\ \{}
\DoxyCodeLine{\ \ \ \ std::string\ protocol;}
\DoxyCodeLine{\ \ \ \ std::string\ host;}
\DoxyCodeLine{\ \ \ \ std::string\ port;}
\DoxyCodeLine{\ \ \ \ std::string\ path;}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{UrlComponents\ parse\_url(\textcolor{keyword}{const}\ std::string\&\ url)}

\end{DoxyCode}



\begin{DoxyItemize}
\item Parses URLs using regex to extract protocol, host, port, and path.
\item Handles default ports (80 for HTTP, 443 for HTTPS) if not specified.
\end{DoxyItemize}\hypertarget{md_doc_2http-adapter-explaination_autotoc_md43}{}\doxysubsection{\texorpdfstring{4. {\ttfamily send\+Get\+Request} Function}{4. {\ttfamily send\+Get\+Request} Function}}\label{md_doc_2http-adapter-explaination_autotoc_md43}

\begin{DoxyCode}{0}
\DoxyCodeLine{HttpResponse\ sendGetRequest(\textcolor{keyword}{const}\ std::string\&\ url,\ \textcolor{keyword}{const}\ std::string\&\ authorizationHeader\ =\ \textcolor{stringliteral}{"{}"{}});}

\end{DoxyCode}



\begin{DoxyItemize}
\item {\bfseries{Purpose}}\+: Sends an HTTP GET request.
\item {\bfseries{Implementation}}\+: Uses Crow to\+:
\begin{DoxyItemize}
\item Parse the URL.
\item Create a Crow application and request object.
\item Set up appropriate headers (Host, User-\/\+Agent, Authorization if provided).
\item Send the request and collect the response.
\item Extract status code, body, and relevant headers.
\end{DoxyItemize}
\item {\bfseries{Parameters}}\+:
\begin{DoxyItemize}
\item {\ttfamily url}\+: Target URL.
\item {\ttfamily authorization\+Header} (optional)\+: Full header string (e.\+g., "{}\+Basic ..."{} or "{}\+Bearer ..."{}).
\end{DoxyItemize}
\item {\bfseries{Returns}}\+: An {\ttfamily Http\+Response} struct with status code, response body, and authorization header.
\item {\bfseries{Error Handling}}\+: Uses try-\/catch blocks for error handling, logging to stderr.
\end{DoxyItemize}\hypertarget{md_doc_2http-adapter-explaination_autotoc_md44}{}\doxysubsection{\texorpdfstring{5. {\ttfamily send\+Post\+Request} Function}{5. {\ttfamily send\+Post\+Request} Function}}\label{md_doc_2http-adapter-explaination_autotoc_md44}

\begin{DoxyCode}{0}
\DoxyCodeLine{HttpResponse\ sendPostRequest(\textcolor{keyword}{const}\ std::string\&\ url,\ }
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ postData,\ }
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ contentType\ =\ \textcolor{stringliteral}{"{}application/json"{}},\ }
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ authorizationHeader\ =\ \textcolor{stringliteral}{"{}"{}});}

\end{DoxyCode}



\begin{DoxyItemize}
\item {\bfseries{Purpose}}\+: Sends an HTTP POST request.
\item {\bfseries{Implementation}}\+: Uses Crow similar to {\ttfamily send\+Get\+Request}, but\+:
\begin{DoxyItemize}
\item Sets the HTTP method to POST.
\item Includes the request body and Content-\/\+Type header.
\end{DoxyItemize}
\item {\bfseries{Parameters}}\+:
\begin{DoxyItemize}
\item {\ttfamily url}\+: Target URL.
\item {\ttfamily post\+Data}\+: Request body (JSON string for Auth\+Proxy).
\item {\ttfamily content\+Type}\+: Content-\/\+Type header value.
\item {\ttfamily authorization\+Header} (optional)\+: Full authorization header string.
\end{DoxyItemize}
\item {\bfseries{Returns}}\+: An {\ttfamily Http\+Response} struct.
\item {\bfseries{Error Handling}}\+: Uses try-\/catch blocks for error handling, logging to stderr.
\end{DoxyItemize}\hypertarget{md_doc_2http-adapter-explaination_autotoc_md45}{}\doxysubsection{\texorpdfstring{6. Auth\+Proxy Helper Functions}{6. Auth\+Proxy Helper Functions}}\label{md_doc_2http-adapter-explaination_autotoc_md45}
The adapter provides convenience methods for specific Auth\+Proxy endpoints\+:\hypertarget{md_doc_2http-adapter-explaination_autotoc_md46}{}\doxysubsubsection{\texorpdfstring{6.\+1 {\ttfamily create\+User} Function}{6.\+1 {\ttfamily create\+User} Function}}\label{md_doc_2http-adapter-explaination_autotoc_md46}

\begin{DoxyCode}{0}
\DoxyCodeLine{HttpResponse\ createUser(\textcolor{keyword}{const}\ std::string\&\ baseUrl,\ \textcolor{keyword}{const}\ std::string\&\ username,\ \textcolor{keyword}{const}\ std::string\&\ password,\ \textcolor{keyword}{const}\ std::string\&\ bearerToken);}

\end{DoxyCode}



\begin{DoxyItemize}
\item {\bfseries{Purpose}}\+: Creates a user in Auth\+Proxy.
\item {\bfseries{Endpoint}}\+: {\ttfamily POST /authproxy/user}
\item {\bfseries{Parameters}}\+:
\begin{DoxyItemize}
\item {\ttfamily base\+Url}\+: Base URL for Auth\+Proxy (e.\+g., "{}http\+://localhost\+:8080"{}).
\item {\ttfamily username}\+: Username to create.
\item {\ttfamily password}\+: Password for the new user.
\item {\ttfamily bearer\+Token}\+: Authentication token for the request (Bearer token).
\end{DoxyItemize}
\item {\bfseries{Returns}}\+: HTTP response from Auth\+Proxy.
\end{DoxyItemize}\hypertarget{md_doc_2http-adapter-explaination_autotoc_md47}{}\doxysubsubsection{\texorpdfstring{6.\+2 {\ttfamily authenticate\+User} Function}{6.\+2 {\ttfamily authenticate\+User} Function}}\label{md_doc_2http-adapter-explaination_autotoc_md47}

\begin{DoxyCode}{0}
\DoxyCodeLine{HttpResponse\ authenticateUser(\textcolor{keyword}{const}\ std::string\&\ baseUrl,\ \textcolor{keyword}{const}\ std::string\&\ username,\ \textcolor{keyword}{const}\ std::string\&\ password);}

\end{DoxyCode}



\begin{DoxyItemize}
\item {\bfseries{Purpose}}\+: Authenticates a user against Auth\+Proxy.
\item {\bfseries{Endpoint}}\+: {\ttfamily GET /authproxy/authenticate}
\item {\bfseries{Parameters}}\+:
\begin{DoxyItemize}
\item {\ttfamily base\+Url}\+: Base URL for Auth\+Proxy.
\item {\ttfamily username}\+: Username for authentication.
\item {\ttfamily password}\+: Password for authentication.
\end{DoxyItemize}
\item {\bfseries{Returns}}\+: HTTP response containing Authenticate header with Bearer token upon successful authentication.
\end{DoxyItemize}\hypertarget{md_doc_2http-adapter-explaination_autotoc_md48}{}\doxysubsubsection{\texorpdfstring{6.\+3 {\ttfamily create\+Lobby} Function}{6.\+3 {\ttfamily create\+Lobby} Function}}\label{md_doc_2http-adapter-explaination_autotoc_md48}

\begin{DoxyCode}{0}
\DoxyCodeLine{HttpResponse\ createLobby(\textcolor{keyword}{const}\ std::string\&\ baseUrl,\ \textcolor{keyword}{const}\ std::string\&\ lobbyName,\ \textcolor{keyword}{const}\ std::string\&\ bearerToken,\ \textcolor{keyword}{const}\ std::string\&\ password\ =\ \textcolor{stringliteral}{"{}"{}});}

\end{DoxyCode}



\begin{DoxyItemize}
\item {\bfseries{Purpose}}\+: Creates a new lobby in Auth\+Proxy.
\item {\bfseries{Endpoint}}\+: {\ttfamily POST /authproxy/lobbys}
\item {\bfseries{Parameters}}\+:
\begin{DoxyItemize}
\item {\ttfamily base\+Url}\+: Base URL for Auth\+Proxy.
\item {\ttfamily lobby\+Name}\+: Name of the lobby to create.
\item {\ttfamily bearer\+Token}\+: Authentication token for the request (Bearer token).
\item {\ttfamily password}\+: Optional password for the lobby.
\end{DoxyItemize}
\item {\bfseries{Returns}}\+: HTTP response from Auth\+Proxy.
\end{DoxyItemize}\hypertarget{md_doc_2http-adapter-explaination_autotoc_md49}{}\doxysection{\texorpdfstring{Dependencies}{Dependencies}}\label{md_doc_2http-adapter-explaination_autotoc_md49}

\begin{DoxyItemize}
\item {\bfseries{Crow C++ Library}}\+: Used for HTTP client functionality.
\item {\bfseries{Standard C++ Libraries}}\+: string, iostream, stdexcept, vector, map, regex.
\end{DoxyItemize}\hypertarget{md_doc_2http-adapter-explaination_autotoc_md50}{}\doxysection{\texorpdfstring{Usage Example}{Usage Example}}\label{md_doc_2http-adapter-explaination_autotoc_md50}

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{comment}{//\ Example:\ Authenticate\ user,\ then\ create\ a\ lobby}}
\DoxyCodeLine{std::string\ baseUrl\ =\ \textcolor{stringliteral}{"{}http://localhost:8080"{}};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//\ Authenticate}}
\DoxyCodeLine{\textcolor{keyword}{auto}\ authResponse\ =\ authenticateUser(baseUrl,\ \textcolor{stringliteral}{"{}myusername"{}},\ \textcolor{stringliteral}{"{}mypassword"{}});}
\DoxyCodeLine{\textcolor{keywordflow}{if}\ (authResponse.http\_code\ ==\ 200)\ \{}
\DoxyCodeLine{\ \ \ \ std::string\ bearerToken\ =\ authResponse.authorizationHeader;}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Bearer\ token\ is\ in\ the\ authorizationHeader\ field}}
\DoxyCodeLine{\ \ \ \ }
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Create\ a\ lobby\ using\ the\ token}}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{auto}\ lobbyResponse\ =\ createLobby(baseUrl,\ \textcolor{stringliteral}{"{}My\ Game\ Lobby"{}},\ bearerToken);}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{if}\ (lobbyResponse.http\_code\ ==\ 200)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ Lobby\ created\ successfully}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Lobby\ created:\ "{}}\ <<\ lobbyResponse.body\ <<\ std::endl;}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\}}

\end{DoxyCode}
 